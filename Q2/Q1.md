Convert the rate constant to per second
k1 = 100.0/60.0  # /s
k2 = 600.0/60.0
k3 = 150.0/60.0

# Define the initial concentrations in uM
E0 = 1
S0 = 10
ES0 = 0
P0 = 0

# copy the four equations derived from A 8.1 here as functions
def dEdt(E, S, ES, P):
    return k2*ES - k1*E*S

def dSdt(E, S, ES, P):
    return k2*ES - k1*E*S + k3*ES

def dESdt(E, S, ES, P):
    return k1*E*S - (k2 + k3)*ES

def dPdt(E, S, ES, P):
    return k3*ES

# Define the initial values for the four concentrations
E = E0
S = S0
ES = ES0
P = P0

h = 1 # a random time intervel
while h < 10:
    #attempt to calculate the RK4 constants, my understanding is that all variables in the functions are ’X‘ in f(x,y)
    F1dE = h * dEdt(E, S, ES, P)
    F1dS = h * dSdt(E, S, ES, P)
    F1dES = h * dESdt(E, S, ES, P)
    F1dP = h * dPdt(E, S, ES, P)

    F2dE = h * dEdt(E+0.5*h, S+0.5*h, ES+0.5*h, P+0.5*h)
    F2dS = h * dSdt(E + 0.5 * h, S + 0.5 * h, ES + 0.5 * h, P + 0.5 * h)
    F2dES = h * dESdt(E+0.5*h, S+0.5*h, ES+0.5*h, P+0.5*h)
    F2dP = h * dPdt(E+0.5*h, S+0.5*h, ES+0.5*h, P+0.5*h)

    F3dE = h * dEdt(E+0.5*h, S+0.5*h, ES+0.5*h, P+0.5*h)
    F3dS = h * dSdt(E + 0.5 * h, S + 0.5 * h, ES + 0.5 * h, P + 0.5 * h)
    F3dES = h * dESdt(E+0.5*h, S+0.5*h, ES+0.5*h, P+0.5*h)
    F3dP = h * dPdt(E+0.5*h, S+0.5*h, ES+0.5*h, P+0.5*h)

    F4dE = h * dEdt(E+h, S+h, ES+h, P+h)
    F4dS = h * dSdt(E + h, S + h, ES + h, P + h)
    F4dES = h * dESdt(E+h, S+h, ES+h, P+h)
    F4dP = h * dPdt(E+h, S+h, ES+h, P+h)

    dEdtH = round(dEdt(E, S, ES, P) + 1/6*(F1dE+2*F2dE+2*F3dE+F4dE),2)
    dSdtH = round(dSdt(E, S, ES, P) + 1 / 6 * (F1dS + 2 * F2dS + 2 * F3dS + F4dS),2)
    dESdtH = round(dEdt(E, S, ES, P) + 1/6*(F1dES+2*F2dES+2*F3dES+F4dES),2)
    dPdtH = round(dPdt(E, S, ES, P) + 1/6*(F1dP+2*F2dP+2*F3dP+F4dP),2)

    h=h+2
    print('rate of E at ' + str(h) + 's is ' + str(dEdtH))
    print('rate of S at ' + str(h) + 's is ' + str(dSdtH))
    print('rate of ES at ' + str(h) + 's is ' + str(dESdtH))
    print('rate of P at ' + str(h) + 's is ' + str(dPdtH))
